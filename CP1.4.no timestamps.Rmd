---
title: "Weight Lifting Machine Learning"
author: "Michael Liquori"
date: "Sunday, August 24, 2014"
output: html_document
---
#Executive Summary
We attempt to answer one question:

1. Can we predict whether weightlifting exercises are done correctly or not using the data available?

In order to accomplish this we applied machine learning techniques to the Weight Lifting Exercise Dataset available at http://groupware.les.inf.puc-rio.br/har.

By doing appropriate pre-processing and using a random forest model we were able to achieve 99.61% on a self-created testing dataset, and 100% accuracy on the 20 assigned test datapoints.

#Pre-Procesing
Read in the data:
```{r}
training<-read.csv("pml-training.csv")
testing<-read.csv("pml-testing.csv")
```
Check for missing data (NAs):
```{r}
sumNA <- function(y) {
  nc <- ncol(y)
  cNAs <- numeric(nc)
  for (i in 1:nc) {
    cNAs[i] <- sum(is.na(y[,i]))
  }
  cNAs
}
sumNA(training)
```
Since so many columns are almost entirely NA, we will eliminate those columns:
```{r}
train1 <- training[,which(sumNA(training)!=19216)]
dim(train1)
```
Remove all non-numeric, add back classe, remove timestamps (non motion data):
```{r}
numCols <- sapply(train1, is.numeric)
train2<-cbind(train1$classe,train1[,numCols])
colnames(train2)[1]<-"classe"
train2<-train2[,-c(2:5)]
```
##Create test and train sets
```{r}
library(caret)
inTrain<- createDataPartition(y=train2$classe, p=0.75, list=FALSE) 
trainset<-train2[inTrain,]
testset<-train2[-inTrain,] 
```
# Model
```{r}
library(randomForest)
fit1<-randomForest(classe~.,data=trainset)
print(fit1)
```
**error rate: 0.42%**
#Cross-Validation
Cross-validating against my created testing data:
```{r}
pred1<-predict(fit1,newdata=testset)
confusionMatrix(pred1,testset$classe) 
```
**Accuracy: .9961**
##Variable Importance, Plot Top 20 Variables:
```{r}
imp<-importance(fit1)
imp2<-imp[order(imp, decreasing=TRUE),]
imp2.df<-data.frame(imp2)
par(las=2) 
par(mar=c(5,8,4,2)) 
barplot(imp2.df$imp2[20:1], horiz=TRUE, main="Importance of Variables",  
        names.arg=row.names(imp2.df)[20:1], 
        border="blue", density=c(20:1),cex.names=0.8)
```

#Predict 20 observation test dataset
```{r}
pred2<-predict(fit1,newdata=testing)
```
**100% accuracy achieved.**